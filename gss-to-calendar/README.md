# gss-to-calendar
Googleスプレッドシート(GSS)に入力した日付をGoogleカレンダー(GC)に自動同期するツール

## 使用技術
- 言語：JavaScript(GAS)

## システムの仕様
### 📁スプレッドシート設計
| A | B | C | D | E | F | G | H |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| **企業名** | **開始日時** | **終了日時** | **選考会場** | **選考詳細** | **選考状況** | **イベントID** | **前回ステータス** |
| User入力 | User入力 | User入力 | User入力 | User入力 | User入力 | **Auto** | **Auto** |

※ G,HはGASからのみ操作可能。ユーザは編集不可。

### 🤖GAS側
### トリガー
以下の条件を満たしたときに実行
    - 「企業名」と「開始日時」が入力されている状態
    - 「選考条件が以下のフェーズである」
        - 説明会
        - ES
        - WEBテスト
        - ES＆WEBテスト　※ここはES⇒WEBテスト⇒ES＆WEBテストの順で変更されたときに予定が重複してしまうが、注意する
        - 一次面接
        - 二次面接
        - 三次面接
        - 最終選考

### 1. バリデーション（モード判定）
- 内容更新
    - 条件：「**イベントID（GSS側かつGC側）**がある」かつ「**選考状況**と**前回ステータス**が同じ」
    - 挙動： イベントIDを使用して、既存の予定を変更。
- 新規作成
    - 条件：「**イベントID（GSS側）**が存在しない」
    - 挙動： 新しい予定を作成後、イベントID・前回ステータス更新
- 選考移行（新規作成）
    - 条件：「**イベントID(GSS)側**がある」かつ「**選考状況**と**前回ステータス**が異なる」
    - 挙動： 新しい予定を作成後、イベントID・前回ステータス更新

- ユーザがイベント削除時に備えて、GSS側とGC側どっちも見る箇所を設けた


### 2. 企業名・選考状況・開始時間・終了時間・詳細・場所・イベントIDを読み込む
- **企業名**
- **場所**：
    - 空欄時**オンライン**
- **開始時間と終了時間**：
    - 「開始時間が0:00でない」かつ「終了時間がある」の **時間指定ありイベント**
    - 「開始時間が0:00」又は「終了時間がなし」の時 **終日イベント** 
- **詳細**
    - 基本的に**なし**
    - ユーザが手動で登録する
- **イベントID**
    - まだ予定が一度も登録されたことない場合は予定追加
    - 登録されている場合は更新

###  3. Googleカレンダーに自動入力
- 予定の形式
```yml
title: {企業名}
date: {開始時間-終了時間}
location: {場所}
description: {詳細}
notification_time: １時間前
```
- `notification_time`：デフォルトは**1時間前**

### 工夫点
- ユーザが予定を削除しても正常な動作（GSS側、GC側両方のIDを参照）
- 重複で予定が入らないようにIDで管理